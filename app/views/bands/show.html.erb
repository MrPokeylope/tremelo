<% provide(:title, "#{@band.name}") %>

<br>
<div class="container">

<!-- Band name and tags -->
  <div class="row">

      <div class="col-xs-3">
        <div class="panel panel-default text-center">
        	<%= image_tag @band.profile_picture.url(:small) %> 
        </div>
      </div>

      <div class="col-xs-9 col-md-9">
      <h1 class="display-name"><%= @band.name %></h1>

        <% for band_genre in BandGenre.where(band_id: @band.id) %>
          <% genre = Genre.find(band_genre.genre_id) %>
          <%= content_tag(:span, "#{genre.content}", :class => 'label label-danger', 
          :style => "background-color: rgb(#{genre.get_red},#{genre.get_green},#{genre.get_blue}") %>

        <% end %>
    </div>
  </div>

  <!-- Left Column -->
  <div class="row">
    <div class="col-sm-3">

		<!-- Info Panel -->
    <div class="panel panel-default">
        <div class="panel-heading">
        	Info
        </div>

        <ul class="list-group">

				<!-- Year Formed -->
        <li class="list-group-item text-right">
        	<span class="pull-left">
        		<strong class="">Formed</strong>
        	</span>
        	2011
        </li>

        <!-- Location-->
        <li class="list-group-item text-right">
        	<span class="pull-left">
        		<strong>Location</strong> 
        	</span> 
        	<%= @band.full_address %>
        </li>

      </ul>
    </div>

    	<% @userbands = UserBand.where(band_id: @band.id) %>

      <!-- Member Panel -->
      <div class="panel panel-default">
        <div class="panel-heading">
            Members
        </div>

        <ul class="list-group">

	        <% if @userbands.empty? %>

		        <h3> No users are members of this band</h3>

	        <% else %>

	        <% @userbands.each do |userband| %>
		        <% user = User.find(userband.user_id) %>
			        <li class="list-group-item text-right">
			        	<span class="pull-left">
			        		<strong class="">Role</strong>
			        	</span>
			        	<%= link_to "#{user.first_name} #{user.last_name}", user %>
			        </li>
		        <% end %>
	        <% end %>

      </ul>
    </div>

      <!-- Band Website Panel -->
      <div class="panel panel-default">
        <div class="panel-heading">
        Website   <i class="fa fa-external-link"></i>
        </div>
        <div class="panel-body">
          <a href="#" class="">Band Website</a>
        </div>
      </div>

      <!-- Activity Panel -->
      <div class="panel panel-default">
        <div class="panel-heading">
            Activity <i class="fa fa-dashboard"></i>
        </div>

        <ul class="list-group">

        <li class="list-group-item text-right">
            <span class="pull-left">
              <strong class="">Shares</strong>
            </span> 
            125
          </li>
          <li class="list-group-item text-right">
            <span class="pull-left">
              <strong class="">Fans</strong>
            </span> 
            78
          </li>
        </ul>

      </div>

      <!-- Social Media Panel -->
      <div class="panel panel-default">
        <div class="panel-heading">
          Social Media
        </div>
        <div class="panel-body"> 
          <i class="fa fa-facebook-official fa-2x"></i> 
          <i class="fa fa-twitter fa-2x"></i> 
        </div>
      </div>

      <!-- Prevent anyone but the correct user 
           from seeing the edit link -->
      <% loggedin_userband = UserBand.find_by(user_id: session[:user_id], band_id: @band.id) %>
      <% if !loggedin_userband.nil?%>
	      <% if loggedin_userband.admin_priveleges == 1 %>
		      
        <%= button_to 'Edit Profile', edit_band_path(@band),
            class: 'btn btn-block', :method => :get %>
	      <% end %>
      <% end %>


    </div> <!-- End left side panels -->

    <!-- About Me-->
    <div class="col-sm-9" contenteditable="false">
      <div class="panel panel-default">
        <div class="panel-heading"> 
          Bio
        </div>
        <div class="panel-body"> 
          <%= @band.about_me %>
        </div>
      </div>

       <!-- Musics Panel -->
  
      <div class="panel panel-default" >
        <div class="panel-heading" contenteditable="false">
          Music
         <% if !loggedin_userband.nil?%>
          <% if loggedin_userband.admin_priveleges == 1 %>
            (<%= link_to "Add/Delete Music", edit_musics_band_path %>)
          <% end %>
        <% end %>
        </div>

        <div class="panel-body">
          <% if !@musics[0].nil? %>
          <div class="row">
            <div class="col-xs-6 col-md-4" style="overflow-y:scroll; height: 350px">
                <ul>
                <% for music in @musics %>
                   <%= link_to music.name, 
                        fetch_musics_path(music_id: music.id), 
                        remote: true %><hr>

                <%end%>
                </ul>
              </div>
              <div id = "music_show" class="col-xs-6 col-md-4">
                <%= render partial:'band_musics/music_show', 
                locals: { music: BandMusic.find_by(band_id: @band.id) } %>
              </div>
          <% else %>
            <%= @band.name %> has not yet uploaded any music

          <%end %>
          </div><!-- End of row -->
        </div>
      </div>
		


	<!-- Videos Panel -->
	
      <div class="panel panel-default" >
        <div class="panel-heading" contenteditable="false">
          Videos 
         <% if !loggedin_userband.nil?%>
          <% if loggedin_userband.admin_priveleges == 1 %>
            (<%= link_to "Add/Delete Videos", edit_videos_band_path %>)
          <% end %>
        <% end %>
        </div>
        <div class="panel-body">
          <% if !@videos[0].nil? %>
          <div class="row">
          	<div class="col-xs-6 col-md-4" style="overflow-y:scroll; height: 350px">
                <ul>
          		  <% for video in @videos %>
                   <%= link_to video.video_name, 
                        fetch_videos_path(video_id: video.id), 
                        remote: true %><hr>

                <%end%>
                </ul>
	          	</div>
              <div id = "video_show" class="col-xs-6 col-md-4">
                
                <%= render partial:'band_videos/video_show', 
                locals: { video: BandVideo.find_by(band_id: @band.id) } %>   
              </div>
          <% else %>
            <%= @band.name %> has not yet uploaded any videos

          <%end %>
          </div><!-- End of row -->
        </div>
      </div>

      </div>
    </div>